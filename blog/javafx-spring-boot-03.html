<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Harun Zafer's personal blog" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="content-security-policy" content=""><title>My blog - JavaFX with Spring Boot Part-03: Advanced Integration</title><meta property="og:title" content="JavaFX with Spring Boot Part-03: Advanced Integration" data-svelte="svelte-zpk4mc">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-69c177ea.css">
	<link rel="stylesheet" href="/_app/assets/prism-one-dark-3b0919cf.css">
	<link rel="stylesheet" href="/_app/assets/_post-387faf02.css">
	<link rel="modulepreload" href="/_app/start-3880466b.js">
	<link rel="modulepreload" href="/_app/chunks/index-ca5692cf.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-82d83227.js">
	<link rel="modulepreload" href="/_app/pages/blog/javafx-spring-boot-03.md-9bf62289.js">
	<link rel="modulepreload" href="/_app/chunks/_post-3b80de77.js">
	</head>
	<body>
		<div>




<div class="container"><div class="profile"><a href="/"><img src="/images/profile-2022-01.jpg" class="profile-image" height="64" width="64" alt="Harun Zafer"></a>
	<div class="profile-about"><h2 style="margin-bottom: 0; font-weight: 700;">Harun Zafer</h2>
		<div class="title svelte-zr3vsr">Software Engineer
			<br>
			NLP Enthusiast
		</div>

		<a href="https://github.com/hrzafer" target="_blank"><img src="/images/icon/github.svg" class="social-icon" alt="github icon"></a>
		<a href="https://www.linkedin.com/in/hrzafer"><img src="/images/icon/linkedin.svg" class="social-icon" alt="linkedin icon"></a></div>
</div>
	<nav class="navbar svelte-21fts9"><div class="toggle svelte-21fts9"><button id="dark-mode-toggle" class="dark-mode-toggle svelte-2dupeq"><svg width="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496"><path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"></path></svg></button>

</div>

	<ul class="svelte-21fts9"><li class="svelte-21fts9"><a href="/blog" title="Blog" class="svelte-21fts9">Blog</a></li>
		<li class="svelte-21fts9"><a href="/projects" title="Projects" class="svelte-21fts9">Projects</a></li>
		<li class="svelte-21fts9"><a href="/contact" title="Contact" class="svelte-21fts9">Contact</a></li></ul>
</nav>

	<main class="svelte-ql32pr">




<h1 class="svelte-q64m19">JavaFX with Spring Boot Part-03: Advanced Integration</h1>

<div class="post-header svelte-q64m19"><div class="post-date svelte-q64m19"><img src="/images/icon/calendar-solid.svg" class="social-icon svelte-q64m19" alt="calendar icon">
		<time datetime="2019-10-23T00:00:00Z" class="svelte-q64m19">2022-04-18</time></div>
	<div class="post-tags svelte-q64m19"><img src="/images/icon/hashtag-solid.svg" class="social-icon svelte-q64m19" alt="calendar icon">
		<div class="category svelte-q64m19"><a href="/#">javafx</a></div><div class="category svelte-q64m19"><a href="/#">spring</a></div></div></div>



<div class="blog-post-content">
<div class="table-of-contents"><h3>All articles in this series</h3>
<ol><li><a href="/blog/javafx-spring-boot-01">JavaFX with Spring Boot Part-01: Introduction</a></li>
<li><a href="/blog/javafx-spring-boot-02">JavaFX with Spring Boot Part-02: Basic Integration</a></li>
<li>JavaFX with Spring Boot Part-03: Advanced Integration</li>
<li><a href="/blog/javafx-spring-boot-04">JavaFX with Spring Boot Part-04: Using FXML</a></li>
<li><a href="/blog/javafx-spring-boot-05">JavaFX with Spring Boot Part-05: FxWeaver Integration</a></li></ol></div>
<br>
<p>In the previous article, we’ve seen a basic/minimal integration of Spring boot with JavaFX. In this article we’re going to see some extra wiring up to get the most out of Spring Boot.</p>
<h2>Creating the Application Context</h2>
<p>In the previous article, we had extended JavaFX’s <code>Application</code> abstract class by overriding its <code>start</code> method. <code>start</code> method and its <code>close</code> counter part are called on the UI thread. On the other hand the <code>init</code> method is called on a non-ui thread and the <code>start</code> is only called after the <code>init</code> method returns. This makes the <code>init</code> method the perfect place to create our <code>ApplicationContext</code>.</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java">  <span class="token keyword">private</span> <span class="token class-name">ConfigurableApplicationContext</span> context<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token class-name">ApplicationContextInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenericApplicationContext</span><span class="token punctuation">></span></span> initializer <span class="token operator">=</span>
              context <span class="token operator">-></span> <span class="token punctuation">&#123;</span>
                  context<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">JavaFxApp</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  context<span class="token punctuation">.</span><span class="token function">registerBean</span><span class="token punctuation">(</span><span class="token class-name">Parameters</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">::</span><span class="token function">getParameters</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpringApplicationBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span><span class="token class-name">SpringBootApp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">initializers</span><span class="token punctuation">(</span>initializer<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token function">getParameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRaw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<h2>Closing the Application Context</h2>
<p>According to the official docs, <code>stop</code> method “provides a convenient place to prepare for application exit and destroy resources”. It is the right place to close the application context as well as to terminate the UI thread by calling <code>Platform.exit()</code>.</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java">  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">Platform</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<h2>Decoupling UI Creation Code from the Application Configuration Code</h2>
<p>In the previous article, we had overridden the <code>start</code> method as follows. Since we only want application-wide initialization and termination related code in the <code>JavaFxApp</code> class, this is not ideal. </p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java"> <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name">Stage</span> primaryStage<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Pane</span> helloPane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pane</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token string">"Hello JavaFx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        primaryStage<span class="token punctuation">.</span><span class="token function">setScene</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Scene</span><span class="token punctuation">(</span>helloPane<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        primaryStage<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Spring provides a great way of communication among components by firing events. We will be using this feature for various things in the upcoming articles. For now, let us make use of it to move the UI creation code in its own place. Since <code>start</code> method is called when the <code>stage</code> object is ready (in other words JavaFX application thread aka UI thread is ready), we want to publish an event in the <code>start</code> method and handle the event in some where else.</p>
<p>Let’s first create an event class for our case.</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StageReadyEvent</span> <span class="token keyword">extends</span> <span class="token class-name">ApplicationEvent</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Getter</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Stage</span> stage<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StageReadyEvent</span><span class="token punctuation">(</span><span class="token class-name">Stage</span> stage<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>stage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stage <span class="token operator">=</span> stage<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>Then create a <code>Listener</code> for this type of event. Since we’ll be creating various events and listeners in the future, it is good the create a new package called <code>event</code> and put all events and their corresponding listeners there. Also, I highly recommend <code>XYZEvent</code> and <code>XYZEventListener</code> pattern for naming event and listener classes.</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StageReadyEventListener</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StageReadyEvent</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> applicationTitle<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StageReadyEventListener</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">,</span>
                                   <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;app.title&#125;"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> applicationTitle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationTitle <span class="token operator">=</span> applicationTitle<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext <span class="token operator">=</span> applicationContext<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">StageReadyEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Stage</span> stage <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getStage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Pane</span> helloPane <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pane</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Label</span><span class="token punctuation">(</span><span class="token string">"Hello JavaFx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stage<span class="token punctuation">.</span><span class="token function">setScene</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Scene</span><span class="token punctuation">(</span>helloPane<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stage<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stage<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>With <code>@Component</code> annotation, spring will take care of creating a <code>StageReadyEventListener</code> object for us. The <code>ApplicationContext</code> we’ve created in the <code>init</code> method will be injected into the constructor by Spring as well. Let’s make use of another Spring goodie by defining a title for our application in the <code>application.properties</code> file.</p>
<pre class="language-properties"><!-- HTML_TAG_START --><code class="language-properties"><span class="token attr-name">app.title</span><span class="token punctuation">=</span><span class="token attr-value">Hello JavaFX with Spring Boot</span></code><!-- HTML_TAG_END --></pre>
<p>As you can see, with the <code>@Value</code> annotation above, Spring will inject the value automatically for us. This way we can keep all application configuration in the <code>application.properties</code> and access them where ever we wan’t. Isn’t that cool? Note that we could do the same for the <code>Hello JavaFx</code> text of the <code>Label</code>. I’ll leave it as an exercise for the reader.</p>
<p>Finally, lets publish the event in the <code>start</code> method.</p>
<pre class="language-java"><!-- HTML_TAG_START --><code class="language-java">  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name">Stage</span> primaryStage<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">publishEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StageReadyEvent</span><span class="token punctuation">(</span>primaryStage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<p>We’re ready to run our application. You should see something similar.</p>
<p><img src="/images/blog/javafx-spring-boot-starter-03-01.png" alt="spring initialz configuration"></p>
<p>In the next article, we’ll use <code>FXWeaver</code>.</p>
<p>Source code for this article can be found <a href="https://github.com/harunzafer/javafx-spring-boot-starter/releases/tag/v0.3" rel="nofollow">here</a></p>
</div></main>

	<footer class="footer svelte-1thw6t4"><p class="svelte-1thw6t4">©2015–2023 Harun Zafer</p>
	<p class="svelte-1thw6t4">Made with <a href="https://kit.svelte.dev/" class="svelte-1thw6t4">SvelteKit</a> using
		<a href="https://jekyll-themes.com/ephesus/" class="svelte-1thw6t4">Ephesus</a>
		theme. Hosted on
		<a href="https://pages.github.com/" class="svelte-1thw6t4">GitHub Pages</a>.
	</p>
</footer>
</div>


		<script type="module" data-hydrate="i7ref">
		import { start } from "/_app/start-3880466b.js";
		start({
			target: document.querySelector('[data-hydrate="i7ref"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-82d83227.js"),
						import("/_app/pages/blog/javafx-spring-boot-03.md-9bf62289.js")
				],
				params: {}
			}
		});
	</script></div>
	</body>
</html>
